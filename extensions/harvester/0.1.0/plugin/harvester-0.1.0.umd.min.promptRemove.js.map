{"version":3,"file":"harvester-0.1.0.umd.min.promptRemove.js","mappings":"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","sources":["webpack://harvester-0.1.0/./promptRemove/kubevirt.io.virtualmachine.vue","webpack://harvester-0.1.0/./promptRemove/kubevirt.io.virtualmachine.vue?8f77"],"sourcesContent":["<script>\nimport { mapState, mapGetters } from 'vuex';\nimport { isEmpty } from '@shell/utils/object';\nimport Parse from 'url-parse';\nimport { resourceNames } from '@shell/utils/string';\nimport { HCI } from '../types';\n\nexport default {\n  name: 'HarvesterPromptRemove',\n\n  props: {\n    value: {\n      type:    Array,\n      default: () => {\n        return [];\n      }\n    },\n\n    names: {\n      type:    Array,\n      default: () => {\n        return [];\n      }\n    },\n\n    type: {\n      type:     String,\n      required: true\n    }\n  },\n\n  data() {\n    return {\n      checkedList: [],\n      checkAll:    true\n    };\n  },\n\n  computed: {\n    ...mapState('action-menu', ['toRemove']),\n    ...mapGetters({ t: 'i18n/t' }),\n\n    removeNameArr() {\n      const out = {};\n\n      this.value.forEach((crd) => {\n        if (crd.type !== HCI.VM) {\n          return;\n        }\n        const volumes = crd.spec.template.spec?.volumes || [];\n        const names = volumes.filter(volume => volume.persistentVolumeClaim ).map((volume) => {\n          if (volume.persistentVolumeClaim) {\n            return volume.name;\n          }\n        });\n\n        out[crd.id] = names;\n      });\n\n      return out;\n    },\n\n    plusMore() {\n      const remaining = this.toRemove.length - this.names.length;\n\n      return this.t('promptRemove.andOthers', { count: remaining });\n    },\n  },\n\n  watch: {\n    removeNameArr: {\n      handler(neu) {\n        if (this.value.length === 1) {\n          const keys = Object.values(neu[this.value[0].id]);\n\n          this.checkedList.unshift(keys[0]);\n        }\n      },\n      deep:      true,\n      immediate: true\n    }\n  },\n\n  methods: {\n    resourceNames,\n    remove() {\n      const parentComponent = this.$parent.$parent.$parent;\n\n      let goTo;\n\n      if (parentComponent.doneLocation) {\n        // doneLocation will recompute to undefined when delete request completes\n        goTo = { ...parentComponent.doneLocation };\n      }\n\n      Promise.all(this.value.map((resource) => {\n        if (resource.type !== HCI.VM) { // maybe is VMI\n          resource.remove();\n\n          return;\n        }\n\n        let removedDisks = '';\n\n        if (this.value.length > 1) {\n          if (this.checkAll) {\n            this.removeNameArr[resource.id].forEach((item) => {\n              removedDisks += `removedDisks=${ item }&`;\n            });\n          }\n        } else {\n          this.checkedList.forEach((item) => {\n            removedDisks += `removedDisks=${ item }&`;\n          });\n          removedDisks.replace(/&$/, '');\n        }\n\n        const parsed = Parse(resource.links.self);\n\n        resource.remove({ url: `${ parsed.pathname }?${ removedDisks }propagationPolicy=Foreground` });\n      })).then((results) => {\n        if ( goTo && !isEmpty(goTo) ) {\n          parentComponent.currentRouter.push(goTo);\n        }\n        parentComponent.close();\n      }).catch((err) => {\n        parentComponent.error = err;\n      });\n    }\n  }\n};\n</script>\n\n<template>\n  <div class=\"mt-10\">\n    {{ t('promptRemove.attemptingToRemove', {type}) }}\n    <span v-clean-html=\"resourceNames(names, plusMore, t)\"></span>\n\n    <div class=\"mt-10\">\n      {{ t('harvester.virtualMachine.promptRemove.title') }}\n    </div>\n    <div v-if=\"value.length === 1\">\n      <span  v-for=\"(name, i) in removeNameArr[value[0].id]\" :key=\"i\" >\n        <label class=\"checkbox-container mr-15\"><input v-model=\"checkedList\" type=\"checkbox\" :label=\"name\" :value=\"name\" />\n          <span\n            class=\"checkbox-custom mr-5\"\n            role=\"checkbox\"\n          />\n          {{ name }}\n        </label>\n      </span>\n    </div>\n\n    <div v-else>\n      <label class=\"checkbox-container mr-15\"><input v-model=\"checkAll\" type=\"checkbox\" />\n        <span\n          class=\"checkbox-custom mr-5\"\n          role=\"checkbox\"\n        />\n        {{ t('harvester.virtualMachine.promptRemove.deleteAll') }}\n      </label>\n    </div>\n  </div>\n</template>\n","import { render } from \"./kubevirt.io.virtualmachine.vue?vue&type=template&id=37a779df\"\nimport script from \"./kubevirt.io.virtualmachine.vue?vue&type=script&lang=js\"\nexport * from \"./kubevirt.io.virtualmachine.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["class","_createElementVNode","role","_createElementBlock","_hoisted_1","_ctx","t","type","$props","$options","resourceNames","names","plusMore","_hoisted_2","_toDisplayString","value","length","_hoisted_3","_Fragment","_renderList","removeNameArr","id","name","i","key","_hoisted_4","$data","checkedList","$event","label","_hoisted_6","_hoisted_7","_hoisted_8","checkAll","_hoisted_9","props","Array","default","String","required","data","computed","mapState","mapGetters","out","this","forEach","crd","HCI","VM","volumes","spec","template","filter","volume","persistentVolumeClaim","map","remaining","toRemove","count","watch","handler","neu","keys","Object","values","unshift","deep","immediate","methods","remove","parentComponent","$parent","goTo","doneLocation","Promise","all","resource","removedDisks","item","replace","parsed","Parse","links","self","url","pathname","then","results","isEmpty","currentRouter","push","close","catch","err","error","__exports__","render"],"sourceRoot":""}